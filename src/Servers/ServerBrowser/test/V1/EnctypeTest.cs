using System.Text;
using System;
using System.Linq;
using UniSpy.Server.ServerBrowser.V1.Abstraction.BaseClass;
using UniSpy.Server.ServerBrowser.V1.Aggregate;
using Xunit;
using UniSpy.Server.Core.Encryption;

public class EnctypeTest
{
    private IEnctypeShareTest encShare = new Enctype2("abcdef");
    [Fact]
    public void EncShare2Test()
    {
        uint[] tbuff = Enumerable.Repeat<uint>(1, 326).ToArray();
        var tbuffUint = Array.ConvertAll(tbuff, Convert.ToUInt32);
        var tbuffpUint = tbuffUint.ToArray();
        encShare.Encshare2(tbuffUint, 309, 6);
        var correctResult = new uint[]
        { 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 5, 17498629, 67830052, 39783468, 510855193, 366629229, 3551672311, 2479564971, 2781774699, 4118137534, 3094373108, 829124753, 3611234592, 1213911675, 3241236538, 3419395059, 3, 17236227, 34013461, 20580121, 306578602, 230830554, 2185634525, 1540642169, 2099507104, 1913332720, 3987761791, 3463819041, 860209457, 3948159327, 2584192363, 2377682576, 1, 2, 4, 8, 16, 32, 64, 128, 256, 512, 1024, 2048, 32775, 32774, 32772, 12, 2389626517, 2938163061, 4097, 1, 1549944694, 2745022601, 3181633273, 1113334022, 2827919296, 1467047999, 1485013325, 2809953970, 4233124407, 61842888, 2999413561, 1295553734, 4062552591, 232414704, 3507545467, 787421828, 1 };
        Assert.True(correctResult.SequenceEqual(correctResult));
    }

    [Fact]
    public void EncShare1Test()
    {
        uint[] sbox = Enumerable.Repeat<uint>(1, 326).ToArray();
        byte[] data = encShare.ConvertUintToBytes(Enumerable.Repeat<uint>(2, 326).ToArray());
        encShare.Encshare1(sbox, data, 0, 16);
        uint[] tbuffCorrect = new uint[] { 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 5, 17498629, 67830052, 39783468, 510855193, 366629229, 3551672311, 2479564971, 2781774699, 4118137534, 3094373108, 829124753, 3611234592, 1213911675, 3241236538, 3419395059, 3, 17236227, 34013461, 20580121, 306578602, 230830554, 2185634525, 1540642169, 2099507104, 1913332720, 3987761791, 3463819041, 860209457, 3948159327, 2584192363, 2377682576, 1, 2, 4, 8, 16, 32, 64, 128, 256, 512, 1024, 2048, 32775, 32774, 32772, 12, 2389626517, 2938163061, 4097, 1, 1549944694, 2745022601, 3181633273, 1113334022, 2827919296, 1467047999, 1485013325, 2809953970, 4233124407, 61842888, 2999413561, 1295553734, 4062552591, 232414704, 3507545467, 787421828, 1 };
        uint[] datapCorrect = new uint[] { 1549944692, 2745022603, 3181633275, 1113334020, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2 };
        uint[] datapUints = encShare.ConvertBytesToUint(data);
        Assert.True(datapCorrect.SequenceEqual(datapUints));
        Assert.True(tbuffCorrect.SequenceEqual(sbox));
    }

    [Fact]
    public void EncShare3Test()
    {
        uint[] data = Enumerable.Repeat<uint>(2, 326).ToArray();
        var dataCorrect = new uint[] { 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 33620998, 135004685, 69605426, 1014894209, 659661192, 2751357934, 70666098, 903130807, 49046030, 3998375437, 390165736, 1818952629, 3823375448, 2963547126, 1207763347, 1, 33620484, 67633672, 35065374, 609093707, 416178922, 41172573, 2689180916, 3999573889, 1412900922, 2353420577, 3107029142, 4152417908, 3761014253, 2622030354, 604491503, 1, 2, 4, 8, 16, 32, 64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384, 32768, 16, 26297853, 3438224389, 65536, 0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2 };
        encShare.EncShare3(data, 0, 0);
        Assert.True(dataCorrect.SequenceEqual(data));
    }

    [Fact]
    public void EncShare4Test()
    {
        byte[] datap = encShare.ConvertUintToBytes(Enumerable.Repeat<uint>(1, 326).ToArray());
        uint[] dest = Enumerable.Repeat<uint>(2, 326).ToArray();
        var destCorrect = new uint[] { 791505064, 2677899357, 1869417374, 1465234252, 2475789121, 740983918, 2189457908, 1330493599, 3469488310, 404138664, 3890561660, 2037844579, 3772710031, 3014765711, 1414723042, 3250538244, 2239997656, 3368442198, 2829463375, 3873709831, 1616809334, 2408416094, 2593714885, 3065269826, 2728411308, 3115826211, 623071236, 1987339440, 3503169148, 3149487561, 3216855940, 4277978053, 2694731547, 943095479, 2947390224, 3284255792, 892575532, 4092678516, 3301083488, 1701020929, 50269918, 1583105766, 1178877547, 3233684681, 100976904, 1279948990, 909431883, 2341052024, 656793440, 1229403759, 825219562, 4059029186, 1111521199, 3435794874, 3486359808, 2088400399, 1498911874, 2458935151, 2138956613, 2661076370, 4193770664, 875740486, 3789516497, 67269043, 3048411365, 3722181363, 3907409649, 842022855, 1785245261, 2997891633, 1027315374, 1448379989, 4244284893, 3856866799, 1397854789, 4294782009, 168303206, 2206334467, 3200035771, 976798254, 2054714062, 1667360351, 1852589230, 4042177498, 3823179561, 1599942934, 437785722, 2223115414, 151501413, 3317924486, 3031575332, 4143189866, 134631422, 4227418534, 2981074340, 3385320959, 117789415, 2711583408, 2879989466, 3991617966, 286206350, 1818888530, 2071585337, 3739025234, 1431558871, 2021051280, 3267424079, 2745248443, 2307337611, 589374105, 2795805112, 1734712546, 2492609632, 4126389475, 4176931104, 2374707415, 3621103376, 3924286366, 2004218049, 84087549, 3957934975, 1212547806, 1549461370, 3082111598, 4025327728, 3132657759, 202009759, 1953642301, 2290488196, 2273689622, 1532595819, 2576839429, 724152551, 2610524026, 1717830723, 1802078870, 2543150389, 2762113475, 538843459, 926252336, 1835774642, 2442121321, 1768364936, 1077865321, 707273192, 3941128409, 50449982, 218878597, 6393, 2778976161, 3183168775, 3520064586, 3974786543, 2863201253, 959919482, 4075851646, 3166321558, 3334784883, 690431172, 336772646, 2964244513, 3705314749, 420976600, 1566245846, 387311668, 1010479510, 2896847722, 2846308697, 319944579, 2930534087, 3351637619, 1195746181, 1650488629, 1751570372, 3418979436, 3570593063, 4008508924, 505193660, 2627368049, 572549046, 252515951, 673636639, 1482054814, 2913665291, 4109518194, 2812631805, 3654778850, 454681732, 33435212, 1296779424, 1364191760, 3536885831, 2644195397, 269380140, 1145189234, 1515732185, 757817052, 1128356723, 1347352576, 3637938136, 1684159756, 3840047978, 3671636355, 2155743464, 2509489735, 555702320, 2559995931, 185189712, 3587438174, 606263025, 2324213583, 2526306506, 488365343, 1094685107, 1313605119, 1886282224, 2105240036, 774640903, 808383289, 993638370, 3553739022, 1162027228, 639955374, 4210601392, 3452684985, 1381031990, 1246242604, 2172609167, 1970533518, 3688480660, 2391593397, 4261137494, 1263113115, 1919957700, 3604219589, 3806348272, 3402139713, 303092719, 1044122905, 370419094, 353606213, 1903121829, 2357873757, 235667635, 4160071907, 2425266738, 3098990011, 521996276, 858858457, 2122099102, 3755824166, 2256844040, 1061009100, 1936812966, 471501886, 1633679743, 2, 3648983511, 3019444315, 3087473871, 3504257679, 3636804204, 677370271, 1517421204, 319045361, 2414764241, 1428393162, 1627687985, 3434938190, 1735044768, 1113717230, 3367048133, 1, 1803453643, 3619135896, 151234568, 3605443923, 1593688450, 2992556862, 3389812064, 1790820139, 3447432721, 1637898815, 1432460662, 2272000269, 3310238632, 964792890, 2941880083, 1, 2, 4, 8, 16, 32, 64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384, 32768, 16, 2110503879, 2280433177, 65536, 0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2 };

        encShare.EncShare4(datap, 1, dest);

        Assert.True(destCorrect.SequenceEqual(dest));
    }
}


public class Encrypt2Test
{
    private IEnctype2Test _enctype2 = new Enctype2("abcdef");
    [Fact]
    public void EncoderTest()
    {
        var data = Enumerable.Repeat<uint>(2, 326).ToArray();
        var dataBytes = _enctype2.ConvertUintToBytes(data);
        _enctype2.Encoder(((Enctype2)_enctype2).GameSecreteKey, dataBytes, 6);
        var dataCorrect = new uint[] { 1667391972, 6710628, 3464277760, 3324666663, 1732499745, 230, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2 };
        data = _enctype2.ConvertBytesToUint(dataBytes);
        Assert.True(dataCorrect.SequenceEqual(data));
    }
}


public class Enctype1Test
{
    [Fact]
    public void Func5Test()
    {
        IEnctype1Test enc1 = (IEnctype1Test)new Enctype1(UniSpyEncoding.GetBytes("abcdef"));
        var encKey = UniSpyEncoding.GetBytes("abcdef");
        var key = UniSpyEncoding.GetBytes("abcdef");
        int n1 = 2, n2 = 2;
        enc1.Func5(5, key, ref n1, ref n2, encKey);
        Assert.True(n1 == 99);
        Assert.True(n2 == 1);
        Assert.True(key.SequenceEqual(UniSpyEncoding.GetBytes("abcdef")));
    }
    [Fact]
    public void Func4Test()
    {
        IEnctype1Test enc1 = (IEnctype1Test)new Enctype1(UniSpyEncoding.GetBytes("abcdef"));

        var key = UniSpyEncoding.GetBytes("abcdef");
        enc1.CreateEnc1Key(enc1.ValidateKey, key);
        Assert.True(key.SequenceEqual(UniSpyEncoding.GetBytes("abcdef")));
        var correctEnc1Key = new byte[] { 35, 53, 63, 48, 8, 15, 110, 160, 40, 34, 38, 172, 125, 28, 118, 9, 22, 107, 36, 16, 46, 104, 6, 136, 32, 50, 101, 132, 21, 119, 190, 20, 114, 154, 33, 42, 98, 39, 131, 70, 56, 144, 4, 120, 2, 26, 149, 18, 0, 153, 24, 44, 12, 152, 10, 138, 51, 133, 71, 17, 5, 202, 3, 208, 11, 128, 134, 83, 14, 41, 23, 52, 122, 151, 47, 116, 27, 108, 139, 214, 113, 75, 250, 78, 145, 86, 57, 124, 111, 45, 126, 59, 147, 65, 141, 137, 143, 69, 96, 148, 30, 105, 95, 196, 129, 146, 62, 109, 54, 81, 130, 102, 68, 115, 60, 117, 58, 140, 74, 121, 66, 123, 64, 142, 135, 127, 72, 99, 166, 76, 220, 82, 226, 112, 89, 80, 77, 92, 29, 90, 87, 84, 93, 178, 232, 100, 150, 88, 155, 184, 238, 106, 244, 94, 161, 156, 157, 158, 159, 1, 167, 162, 163, 164, 165, 7, 173, 168, 169, 170, 171, 13, 179, 174, 175, 176, 177, 19, 185, 180, 181, 182, 183, 25, 191, 186, 187, 188, 189, 31, 197, 192, 193, 194, 195, 37, 203, 198, 199, 200, 201, 43, 209, 204, 205, 206, 207, 49, 215, 210, 211, 212, 213, 55, 221, 216, 217, 218, 219, 61, 227, 222, 223, 224, 225, 67, 233, 228, 229, 230, 231, 73, 239, 234, 235, 236, 237, 79, 245, 240, 241, 242, 243, 85, 251, 246, 247, 248, 249, 91, 103, 252, 253, 254, 255, 97, 53, 48, 15, 160, 45 };
        Assert.True(enc1.Enc1Key.SequenceEqual(correctEnc1Key));
    }

    [Fact]
    public void Func7Test()
    {
        IEnctype1Test enc1 = (IEnctype1Test)new Enctype1(UniSpyEncoding.GetBytes("abcdef"));
        var r = enc1.SubstituteEnc1key(10, enc1.Enc1Key);
        var correctEnc1Key = new byte[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 10, 10 };
        Assert.True(enc1.Enc1Key.SequenceEqual(correctEnc1Key));
    }

    [Fact]
    public void Func8Test()
    {
        IEnctype1Test enc1 = (IEnctype1Test)new Enctype1(UniSpyEncoding.GetBytes("abcdef"));
        var data = enc1.ConvertUintToBytes(Enumerable.Repeat<uint>(1, 326).ToArray());
        enc1.Func8(data, 10, Enctype1.MasterKey);
        var correctData = new uint[] { 16843194, 16843194, 442, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 };
        var dataUints = enc1.ConvertBytesToUint(data);
        Assert.True(correctData.SequenceEqual(dataUints));
    }

    [Fact]
    public void Func6Test()
    {
        IEnctype1Test enc1 = (IEnctype1Test)new Enctype1(UniSpyEncoding.GetBytes("abcdef"));
        var data = enc1.ConvertUintToBytes(Enumerable.Repeat<uint>(1, 326).ToArray());
        enc1.EncryptByEnc1Key(data, 10, enc1.Enc1Key);
        var correctData = new byte[] { 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0 };
        Assert.True(correctData.SequenceEqual(data));
        var enc1KeyCorrect = new byte[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 0, 0, 0, 0 };
        Assert.True(enc1KeyCorrect.SequenceEqual(enc1.Enc1Key));
    }

    [Fact]
    public void Func3Test()
    {
        IEnctype1Test enc1 = (IEnctype1Test)new Enctype1(UniSpyEncoding.GetBytes("abcdef"));
        var data = enc1.ConvertUintToBytes(Enumerable.Repeat<uint>(1, 326).ToArray());
        var buff = enc1.ConvertUintToBytes(Enumerable.Repeat<uint>(2, 326).ToArray());
        enc1.CreateEnc0Key(data, 10, buff);
        var correctBuff = new uint[] { 2423783724, 2626217045, 2666177577, 3362939995, 3417775348, 3999423967, 1642197989, 91342666, 3246176910, 455134510, 3298402371, 2675676894, 4059931565, 2176375884, 1087007327, 3680970979, 2960389948, 3992074825, 449167537, 4019542232, 3920131915, 1672128080, 1953860086, 2635063843, 499266173, 995782236, 1863130809, 2899638540, 3943859670, 3611120871, 2705294232, 1747078419, 1389594391, 1704679349, 830416758, 2357868666, 556737645, 2486454320, 184857584, 1150109371, 1338197782, 1775337177, 3216789815, 2952129716, 713304926, 4209027549, 171131454, 2933556984, 2184588750, 896240384, 1895567724, 121182412, 4283344853, 2548565524, 242815122, 1444522835, 3062851200, 3486691985, 3499345562, 631422715, 149333344, 1096400159, 4261619269, 164173058, 0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2 };
        var buffUints = enc1.ConvertBytesToUint(buff);
        Assert.True(correctBuff.SequenceEqual(buffUints));
    }

    [Fact]
    public void Func2Test()
    {
        IEnctype1Test enc1 = (IEnctype1Test)new Enctype1(UniSpyEncoding.GetBytes("abcdef"));
        var data = enc1.ConvertUintToBytes(Enumerable.Repeat<uint>(1, 326).ToArray());
        var crypt = enc1.ConvertUintToBytes(Enumerable.Repeat<uint>(2, 326).ToArray());
        enc1.EncryptByEnc0Key(data, 10, crypt);
        var correctBuff = new uint[] { 33554432, 131584, 512, 0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1548, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2 };
        var buffUints = enc1.ConvertBytesToUint(crypt);
        Assert.True(correctBuff.SequenceEqual(buffUints));
    }

    [Fact]
    public void TotalEncTest()
    {
        // Given
        var key = Encoding.ASCII.GetBytes("123456");
        var plainText = Encoding.ASCII.GetBytes("000000000000000000000000000000000000");
        var enc = new Enctype1(key);
        var result = enc.Encrypt(plainText);
        // When

        // Then
    }
}